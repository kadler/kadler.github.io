<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Mucking with the Runtime Library Search Path on PASE - Kevin’s Ramblings</title>
<meta name="description" content="In my last blog I showed how the LIBPATH gets used and also how the runtime search path in the binary gets used. LIBPATH is obviously set as an environment variable, but how does that runtime search path get generated? Let’s explore!">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Kevin's Ramblings">
<meta property="og:title" content="Mucking with the Runtime Library Search Path on PASE">
<meta property="og:url" content="https://kadler.io/2017/11/17/how-to-libpath.html">


  <meta property="og:description" content="In my last blog I showed how the LIBPATH gets used and also how the runtime search path in the binary gets used. LIBPATH is obviously set as an environment variable, but how does that runtime search path get generated? Let’s explore!">







  <meta property="article:published_time" content="2017-11-17T12:13:14-06:00">






<link rel="canonical" href="https://kadler.io/2017/11/17/how-to-libpath.html">













<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Kevin's Ramblings Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">Kevin's Ramblings</a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/posts/">Posts</a>
            </li>
<li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li>
<li class="masthead__menu-item">
              <a href="/year-archive/">Archive</a>
            </li>
<li class="masthead__menu-item">
              <a href="/ebcdic/">EBCDIC</a>
            </li>
<li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li>
</ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/bio-photo.jpg" alt="Kevin Adler" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Kevin Adler</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Open Source Dude</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Rochester, MN</span>
        </li>
      

      
        
          
            <li><a href="https://github.com/kadler" rel="me nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://mastodon.lol/@kadler" rel="me nofollow noopener noreferrer"><i class="fab fa-fw fa-mastodon" aria-hidden="true"></i><span class="label">Mastodon</span></a></li>
          
        
          
            <li><a href="https://twitter.com/kadlerio" rel="me nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://stackoverflow.com/users/3245633/kevin-adler" rel="me nofollow noopener noreferrer"><i class="fab fa-fw fa-stack-overflow" aria-hidden="true"></i><span class="label">Stack Overflow</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/kevin-adler-19038a15" rel="me nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="https://bitbucket.org/kadler" rel="me nofollow noopener noreferrer"><i class="fab fa-fw fa-bitbucket" aria-hidden="true"></i><span class="label">BitBucket</span></a></li>
          
        
          
            <li><a href="https://gitlab.com/kadler" rel="me nofollow noopener noreferrer"><i class="fab fa-fw fa-gitlab" aria-hidden="true"></i><span class="label">GitLab</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Mucking with the Runtime Library Search Path on PASE">
    <meta itemprop="description" content="In my last blog I showed how the LIBPATH gets used and also how the runtime search path in the binary gets used. LIBPATH is obviously set as an environment variable, but how does that runtime search path get generated? Let’s explore!">
    <meta itemprop="datePublished" content="November 17, 2017">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Mucking with the Runtime Library Search Path on PASE
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  6 minute read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>In my last blog I showed how the <code class="language-plaintext highlighter-rouge">LIBPATH</code> gets used and also how the runtime search path in the binary gets used. <code class="language-plaintext highlighter-rouge">LIBPATH</code> is obviously set as an environment variable, but how does that runtime search path get generated? Let’s explore!</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt;
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Hello world!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Above is a pretty standard “Hello World” program in C. Let’s compile it and look at its search path</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>gcc <span class="nt">-o</span> hello hello.c

<span class="nv">$ </span>dump <span class="nt">-H</span> hello

hello:

                        <span class="k">***</span>Loader Section<span class="k">***</span>
                      Loader Header Information
VERSION#         <span class="c">#SYMtableENT     #RELOCent        LENidSTR</span>
0x00000001       0x0000000b       0x0000002b       0x000000d3

<span class="c">#IMPfilID        OFFidSTR         LENstrTBL        OFFstrTBL</span>
0x00000002       0x0000032c       0x00000039       0x000003ff


                        <span class="k">***</span>Import File Strings<span class="k">***</span>
INDEX  PATH                          BASE                MEMBER
0      /QOpenSys/opt/freeware/bin/../lib/gcc/powerpc-ibm-aix7.1.0.0/4.8.3:/QOpenSys/opt/freeware/bin/../lib/gcc:/QOpenSys/opt/freeware/bin/../lib/gcc/powerpc-ibm-aix7.1.0.0/4.8.3/../../..:/usr/lib:/lib
1                                    libc.a              shr.o
</code></pre></div></div>

<p>What the what? Where did all that junk come from?</p>

<p>The default behavior for the linker (<code class="language-plaintext highlighter-rouge">ld</code>) is to add whatever directories are passed to the linker to find libraries (via the <code class="language-plaintext highlighter-rouge">-L</code> argument) as well as the default search path (<code class="language-plaintext highlighter-rouge">/usr/lib:/lib</code>). We can see that GCC is automatically adding some of its own library directories to be searched whenever you tell it to compile a binary:</p>

<ul>
  <li>/QOpenSys/opt/freeware/bin/../lib/gcc/powerpc-ibm-aix7.1.0.0/4.8.3</li>
  <li>/QOpenSys/opt/freeware/bin/../lib/gcc</li>
  <li>/QOpenSys/opt/freeware/bin/../lib/gcc/powerpc-ibm-aix7.1.0.0/4.8.3/../../..</li>
</ul>

<p>If we canonicalize the relative paths, they then become:</p>

<ul>
  <li>/QOpenSys/opt/freeware/lib/gcc/powerpc-ibm-aix7.1.0.0/4.8.3</li>
  <li>/QOpenSys/opt/freeware/lib/gcc</li>
  <li>/QOpenSys/opt/freeware/lib</li>
</ul>
      <h2 id="its-a-bypass-gotta-build-bypasses">
        
        
          “It’s a bypass! Gotta build bypasses!” <a href="#its-a-bypass-gotta-build-bypasses"></a>
        
        
      </h2>
<p>Let’s bypass GCC and link the binary ourselves:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>gcc <span class="nt">-c</span> <span class="nt">-o</span> hello.o hello.c

<span class="nv">$ </span>ld <span class="nt">-o</span> hello hello.o /QOpenSys/usr/lib/crt0.o <span class="nt">-lc</span>
</code></pre></div></div>

<p>We have to link in <code class="language-plaintext highlighter-rouge">crt0.o</code> as we define a <code class="language-plaintext highlighter-rouge">main()</code> function, but the default entry point for a program is <code class="language-plaintext highlighter-rouge">__start</code> on AIX, so there’s a special glue module that does the necessary setup from the <code class="language-plaintext highlighter-rouge">__start</code> entry point to call <code class="language-plaintext highlighter-rouge">main()</code>. We also need to link with <code class="language-plaintext highlighter-rouge">libc</code>, to get access to <code class="language-plaintext highlighter-rouge">printf</code>. Let’s look at the <code class="language-plaintext highlighter-rouge">dump</code> output now:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>dump <span class="nt">-H</span> hello

hello:

                        <span class="k">***</span>Loader Section<span class="k">***</span>
                      Loader Header Information
VERSION#         <span class="c">#SYMtableENT     #RELOCent        LENidSTR</span>
0x00000001       0x00000008       0x00000010       0x0000001e

<span class="c">#IMPfilID        OFFidSTR         LENstrTBL        OFFstrTBL</span>
0x00000002       0x000001a0       0x00000039       0x000001be


                        <span class="k">***</span>Import File Strings<span class="k">***</span>
INDEX  PATH                          BASE                MEMBER
0      /usr/lib:/lib
1                                    libc.a              shr.o
</code></pre></div></div>

<p>See now it has only added the default search path, since we did not pass any additional <code class="language-plaintext highlighter-rouge">-L</code> arguments to <code class="language-plaintext highlighter-rouge">ld</code>. Let’s see what happens when we add a path:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ld <span class="nt">-o</span> hello hello.o /QOpenSys/usr/lib/crt0.o <span class="nt">-lc</span> <span class="nt">-L</span>/this/path/is/bad/and/you/should/feel/bad

<span class="nv">$ </span>dump <span class="nt">-H</span> hello

hello:

                        <span class="k">***</span>Loader Section<span class="k">***</span>
                      Loader Header Information
VERSION#         <span class="c">#SYMtableENT     #RELOCent        LENidSTR</span>
0x00000001       0x00000008       0x00000010       0x00000048

<span class="c">#IMPfilID        OFFidSTR         LENstrTBL        OFFstrTBL</span>
0x00000002       0x000001a0       0x00000039       0x000001e8


                        <span class="k">***</span>Import File Strings<span class="k">***</span>
INDEX  PATH                          BASE                MEMBER
0      /this/path/is/bad/and/you/should/feel/bad:/usr/lib:/lib
1                                    libc.a              shr.o
</code></pre></div></div>

<p>Boom! We added a path to the runtime search path. Sometimes you really don’t want this, though. Let’s say you’re compiling a library and an application. The library is called <code class="language-plaintext highlighter-rouge">libfoo.a</code> and the binary is called <code class="language-plaintext highlighter-rouge">foo</code>. While building, you first build <code class="language-plaintext highlighter-rouge">libfoo.a</code> in to the current directory, then you go to build <code class="language-plaintext highlighter-rouge">foo</code>. Since <code class="language-plaintext highlighter-rouge">foo</code> needs to link to <code class="language-plaintext highlighter-rouge">libfoo</code>, you need to tell <code class="language-plaintext highlighter-rouge">ld</code> where to find it during build time. You might do something like this:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ld <span class="nt">-o</span> foo foo.o /QOpenSys/usr/lib/crt0.o <span class="nt">-L</span><span class="nb">.</span> <span class="nt">-lfoo</span> <span class="nt">-lc</span>

<span class="nv">$ </span>dump <span class="nt">-H</span> foo

foo:

                        <span class="k">***</span>Loader Section<span class="k">***</span>
                      Loader Header Information
VERSION#         <span class="c">#SYMtableENT     #RELOCent        LENidSTR</span>
0x00000001       0x00000008       0x00000010       0x00000048

<span class="c">#IMPfilID        OFFidSTR         LENstrTBL        OFFstrTBL</span>
0x00000002       0x000001a0       0x00000039       0x000001e8


                        <span class="k">***</span>Import File Strings<span class="k">***</span>
INDEX  PATH                          BASE                MEMBER
0      .:/usr/lib:/lib
1                                    libc.a              shr.o
2                                    libfoo.a            shr.o
</code></pre></div></div>

<p>Now when you install the application, you copy <code class="language-plaintext highlighter-rouge">foo</code> in to <code class="language-plaintext highlighter-rouge">/usr/bin</code> and <code class="language-plaintext highlighter-rouge">libfoo.a</code> in to <code class="language-plaintext highlighter-rouge">/usr/lib</code>. You run your application and everything works great (since <code class="language-plaintext highlighter-rouge">libfoo.a</code> gets loaded from <code class="language-plaintext highlighter-rouge">/usr/lib/libfoo.a</code> via the runtime path). Now though, you’re doing some more development and you run <code class="language-plaintext highlighter-rouge">foo</code> but it gives a load error about missing symbols. What gives? Well, the directory you’re in happens to have an old <code class="language-plaintext highlighter-rouge">libfoo.a</code> and is found first via <code class="language-plaintext highlighter-rouge">./libfoo.a</code> due to ‘.’ being on the runtime search path before <code class="language-plaintext highlighter-rouge">/usr/lib</code>! That’s no good! Heck, that could even be a security issue if your application could be tricked in to loading a malicious library that the attacker tricks you in to uploading.</p>

<p>So lets say we don’t want to include these paths in our finished binary? How do we get rid of them. Well, <code class="language-plaintext highlighter-rouge">ld</code> has an option <code class="language-plaintext highlighter-rouge">-bnolibpath</code> that takes care of that:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ld <span class="nt">-o</span> foo foo.o /QOpenSys/usr/lib/crt0.o <span class="nt">-bnolibpath</span> <span class="nt">-L</span><span class="nb">.</span> <span class="nt">-lfoo</span> <span class="nt">-lc</span>

<span class="nv">$ </span>dump <span class="nt">-H</span> foo

foo:

                        <span class="k">***</span>Loader Section<span class="k">***</span>
                      Loader Header Information
VERSION#         <span class="c">#SYMtableENT     #RELOCent        LENidSTR</span>
0x00000001       0x00000008       0x00000010       0x00000048

<span class="c">#IMPfilID        OFFidSTR         LENstrTBL        OFFstrTBL</span>
0x00000002       0x000001a0       0x00000039       0x000001e8


                        <span class="k">***</span>Import File Strings<span class="k">***</span>
INDEX  PATH                          BASE                MEMBER
0      /usr/lib:/lib
1                                    libc.a              shr.o
2                                    libfoo.a            shr.o
</code></pre></div></div>

<p>One thing to know about the -bnolibpath option is that it isn’t hard-coded to <code class="language-plaintext highlighter-rouge">/usr/lib:/lib</code>, but will use the value of the <code class="language-plaintext highlighter-rouge">LIBPATH</code> environment variable if it is set:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ LIBPATH</span><span class="o">=</span>/QOpenSys/usr/lib ld <span class="nt">-o</span> foo foo.o /QOpenSys/usr/lib/crt0.o <span class="nt">-bnolibpath</span> <span class="nt">-L</span><span class="nb">.</span> <span class="nt">-lfoo</span> <span class="nt">-lc</span>

<span class="nv">$ </span>dump <span class="nt">-H</span> foo

foo:

                        <span class="k">***</span>Loader Section<span class="k">***</span>
                      Loader Header Information
VERSION#         <span class="c">#SYMtableENT     #RELOCent        LENidSTR</span>
0x00000001       0x00000008       0x00000010       0x00000048

<span class="c">#IMPfilID        OFFidSTR         LENstrTBL        OFFstrTBL</span>
0x00000002       0x000001a0       0x00000039       0x000001e8


                        <span class="k">***</span>Import File Strings<span class="k">***</span>
INDEX  PATH                          BASE                MEMBER
0      /QOpenSys/usr/lib
1                                    libc.a              shr.o
2                                    libfoo.a            shr.o
</code></pre></div></div>

<p>Or you can use the <code class="language-plaintext highlighter-rouge">-blibpath</code> option to explicitly set it:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ld <span class="nt">-o</span> foo foo.o /QOpenSys/usr/lib/crt0.o <span class="nt">-L</span><span class="nb">.</span> <span class="nt">-lfoo</span> <span class="nt">-lc</span> <span class="nt">-blibpath</span>:/opt/mypath:/QOpenSys/usr/lib

<span class="nv">$ </span>dump <span class="nt">-H</span> foo

foo:

                        <span class="k">***</span>Loader Section<span class="k">***</span>
                      Loader Header Information
VERSION#         <span class="c">#SYMtableENT     #RELOCent        LENidSTR</span>
0x00000001       0x00000008       0x00000010       0x00000048

<span class="c">#IMPfilID        OFFidSTR         LENstrTBL        OFFstrTBL</span>
0x00000002       0x000001a0       0x00000039       0x000001e8


                        <span class="k">***</span>Import File Strings<span class="k">***</span>
INDEX  PATH                          BASE                MEMBER
0      /opt/mypath:/QOpenSys/usr/lib
1                                    libc.a              shr.o
2                                    libfoo.a            shr.o
</code></pre></div></div>

<p>There’s one other thing to know: you can also hard-code the path to a specific library so that it will not use the search path at all. You do this by passing the full path to the library as an input to <code class="language-plaintext highlighter-rouge">ld</code> instead of having <code class="language-plaintext highlighter-rouge">ld</code> find it via the <code class="language-plaintext highlighter-rouge">-l</code> option:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ld <span class="nt">-o</span> hello hello.o /QOpenSys/usr/lib/crt0.o /QOpenSys/usr/lib/libc.a

<span class="nv">$ </span>dump <span class="nt">-H</span> hello

hello:

                        <span class="k">***</span>Loader Section<span class="k">***</span>
                      Loader Header Information
VERSION#         <span class="c">#SYMtableENT     #RELOCent        LENidSTR</span>
0x00000001       0x00000008       0x00000010       0x00000048

<span class="c">#IMPfilID        OFFidSTR         LENstrTBL        OFFstrTBL</span>
0x00000002       0x000001a0       0x00000039       0x000001e8


                        <span class="k">***</span>Import File Strings<span class="k">***</span>
INDEX  PATH                          BASE                MEMBER
0      /usr/lib:/lib
1      /QOpenSys/usr/lib             libc.a              shr.o
</code></pre></div></div>

<p>You can see above that the <code class="language-plaintext highlighter-rouge">PATH</code> field is set for index 2, so now <code class="language-plaintext highlighter-rouge">libc.a</code> will always be loaded from <code class="language-plaintext highlighter-rouge">/QOpenSys/usr/lib/libc.a</code> and will ignore the runtime search path as well as the <code class="language-plaintext highlighter-rouge">LIBPATH</code> environment variable. If that’s not what you want, you can tell the linker to ignore qualified library paths given on the command line and always search for these at runtime with the <code class="language-plaintext highlighter-rouge">-bnoipath</code> option:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ld <span class="nt">-o</span> hello hello.o /QOpenSys/usr/lib/crt0.o <span class="nt">-bnoipath</span> /QOpenSys/usr/lib/libc.a

<span class="nv">$ </span>dump <span class="nt">-H</span> hello

hello:

                        <span class="k">***</span>Loader Section<span class="k">***</span>
                      Loader Header Information
VERSION#         <span class="c">#SYMtableENT     #RELOCent        LENidSTR</span>
0x00000001       0x00000008       0x00000010       0x00000048

<span class="c">#IMPfilID        OFFidSTR         LENstrTBL        OFFstrTBL</span>
0x00000002       0x000001a0       0x00000039       0x000001e8


                        <span class="k">***</span>Import File Strings<span class="k">***</span>
INDEX  PATH                          BASE                MEMBER
0      /usr/lib:/lib
1                                    libc.a              shr.o
</code></pre></div></div>

<p>Ok, so we’ve learned about the <code class="language-plaintext highlighter-rouge">-bnolibpath</code>, <code class="language-plaintext highlighter-rouge">-blibpath</code>, and <code class="language-plaintext highlighter-rouge">-bnoipath</code> <code class="language-plaintext highlighter-rouge">ld</code> options, but most of the time we’re not going to be calling <code class="language-plaintext highlighter-rouge">ld</code> directly, but instead we let our compiler handle calling the linker. How do we tell <code class="language-plaintext highlighter-rouge">gcc</code> to customize these options? Well, <code class="language-plaintext highlighter-rouge">gcc</code> has a way to pass linker flags to <code class="language-plaintext highlighter-rouge">ld</code> via the <code class="language-plaintext highlighter-rouge">-Wl,</code> option. Just prefix the linker option with <code class="language-plaintext highlighter-rouge">-Wl,</code> and pass it to <code class="language-plaintext highlighter-rouge">gcc</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>gcc <span class="nt">-o</span> hello hello.c <span class="nt">-Wl</span>,-bnolibpath

<span class="nv">$ </span>dump <span class="nt">-H</span> hello

hello:

                        <span class="k">***</span>Loader Section<span class="k">***</span>
                      Loader Header Information
VERSION#         <span class="c">#SYMtableENT     #RELOCent        LENidSTR</span>
0x00000001       0x00000008       0x00000010       0x00000048

<span class="c">#IMPfilID        OFFidSTR         LENstrTBL        OFFstrTBL</span>
0x00000002       0x000001a0       0x00000039       0x000001e8


                        <span class="k">***</span>Import File Strings<span class="k">***</span>
INDEX  PATH                          BASE                MEMBER
0      /usr/lib:/lib
1                                    libc.a              shr.o
</code></pre></div></div>
    
      <h2 id="and-thats-all-i-have-to-say-about-that-for-now">
        
        
          And that’s all I have to say about that. (For now?) <a href="#and-thats-all-i-have-to-say-about-that-for-now"></a>
        
        
      </h2>

<p>So what’s the takeaway from all this?</p>

<p>I recommend using the <code class="language-plaintext highlighter-rouge">-blibpath</code> option to explicitly set your runtime library search path. This prevents GCC from adding weird directories to your search path, potentially problematic paths like ‘.’ to your search path, but prevents your users from having to set the <code class="language-plaintext highlighter-rouge">LIBPATH</code> to find your stuff thus relegating <code class="language-plaintext highlighter-rouge">LIBPATH</code> for when a user installs the library in to a different path or you need to override an installed library with your own for debug/test reasons.</p>
        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/libpath" class="page__taxonomy-item" rel="tag">libpath</a><span class="sep">, </span>
    
      
      
      <a href="/categories/pase" class="page__taxonomy-item" rel="tag">pase</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2017-11-17T12:13:14-06:00">November 17, 2017</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/2017/09/08/libpath.html" class="pagination--pager" title="LIBPATH… How Does It Work?
">Previous</a>
    
    
      <a href="/2018/01/08/fetching-python-database-cursors-by-column-name.html" class="pagination--pager" title="Fetching Python Database Cursors by Column Name
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2022/05/20/odbc-repos.html" rel="permalink">IBM-provided Repositories ODBC Linux Driver Repositories
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Today, we’re pushing out something that I’ve been wanting for a long time. We
now have RPM and DEB repositories for Linux available directly from IBM for the...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2022/02/21/jan-2022-oss-updates.html" rel="permalink">IBM i Open Source Updates January 2022
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Happy new year! I know it’s late February now, but it’s still the first post of
2022 here, so let’s see what January had to offer. <img class="emoji" title=":grin:" alt=":grin:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f601.png" height="20" width="20">
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2022/01/31/dec-2021-oss-updates.html" rel="permalink">IBM i Open Source Updates December 2021
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  3 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Just because the last couple months were quiet doesn’t mean that nothing’s
going on. Case in point, the last month of 2021 saw a ton of updates, though
many ...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2022/01/24/nov-2021-oss-updates.html" rel="permalink">IBM i Open Source Updates November 2021
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  less than 1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">November brings some nice goodies for IBM i 7.3+ users and some security fixes.
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2023 Kevin's Ramblings. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
